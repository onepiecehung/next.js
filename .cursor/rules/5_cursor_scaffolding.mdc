---
alwaysApply: true
---

# âš™ï¸ Cursor Scaffolding & Definition of Done

## âš ï¸ BEFORE Creating Anything: Check MCP Tools First!

**MANDATORY Steps:**
1. ğŸ” **Search shadcn MCP** - Check if component already exists
2. ğŸ“š **Check Next.js MCP** - Verify best practices and patterns
3. âœ… **Only create custom** - If MCP doesn't provide solution

See `8_mcp_tools.mdc` for detailed MCP usage guidelines.

---

## Cursor Scaffolding

**When:** `Create page <slug>`
1. **FIRST**: Check MCP for existing page patterns
2. `src/app/<slug>/page.tsx` â€” RSC page
3. `src/components/features/<slug>/*`
4. `src/lib/api/<slug>.ts`
5. `src/hooks/use<Slug>.ts`
6. `src/i18n/locales/{en,vi}/<slug>.json`
7. `src/__tests__/<slug>.spec.tsx`

**Page Metadata & SEO (MANDATORY for all pages):**
- Use `usePageMetadata` hook from `@/hooks/ui/use-page-metadata` for client components
- Updates: `document.title`, meta tags, Open Graph, Twitter Cards, canonical URL
- **Example:**
```tsx
import { usePageMetadata } from "@/hooks/ui/use-page-metadata";

export default function MyPage() {
  usePageMetadata({
    title: t("pageTitle", "namespace"),
    description: t("pageDescription", "namespace"),
    image: data?.coverImage,
    url: `https://example.com${pathname}`,
    keywords: ["keyword1", "keyword2"],
    type: "article", // or "website"
  });
  // ...
}
```

**Breadcrumb Navigation (RECOMMENDED for nested routes):**
- Use `useBreadcrumb` hook from `@/hooks/ui/useBreadcrumb` for automatic breadcrumb generation
- Use `BreadcrumbNav` component from `@/components/features/navigation/breadcrumb-nav`
- Supports i18n translation keys and dynamic params (titles, usernames, etc.)
- **Example:**
```tsx
import { useBreadcrumb } from "@/hooks/ui/useBreadcrumb";
import { BreadcrumbNav } from "@/components/features/navigation";

export default function MyPage() {
  const breadcrumbItems = useBreadcrumb(undefined, {
    series_id: seriesId,
    series_title: series?.title,
    // ... other dynamic params
  });
  
  return (
    <div>
      <BreadcrumbNav items={breadcrumbItems} />
      {/* ... rest of page */}
    </div>
  );
}
```
- **For custom breadcrumbs:** Pass items directly: `useBreadcrumb([{ label: "...", href: "..." }])`
- **Translation keys:** Use `nav.breadcrumb.*` keys in `common.json` namespace

**When:** `Create form <name>`
- **FIRST**: Search shadcn MCP for form components
- Path: `src/components/features/<domain>/<name>-form.tsx`
- Use RHF + Zod + shadcn `<Form />`
- Disabled/loading state + toast

**When:** `Create modal <name>`
- **FIRST**: Check shadcn MCP for Dialog/Sheet components
- Use `Dialog`/`Sheet`
- Focus trap, ESC close, responsive sizing

**When:** `Add UI component <name>`
- **MANDATORY**: Use `mcp_shadcn_search_items_in_registries` first
- Get installation: `mcp_shadcn_get_add_command_for_items`
- Get examples: `mcp_shadcn_get_item_examples_from_registries`
- Only create custom if not available in MCP

> âŒ Never create `app/api/*` or `"use server"`.
> âœ… Always use `src/lib/http/client.ts`.
> âš ï¸ Always check MCP tools BEFORE creating new components.

---

## âœ… Definition of Done

| Check | Status |
|-------|--------|
| MCP tools checked before creating | âœ… |
| No TS/ESLint warnings | âœ… |
| Theme dark/light + color variants works | âœ… |
| Mobile-first responsive | âœ… |
| No secrets/server actions | âœ… |
| shadcn primitives w/ states | âœ… |
| i18n EN+VI ready (9 namespaces) | âœ… |
| Accessible (focus, aria, nav) | âœ… |
| Tests â‰¥ 80% coverage | âœ… |
| HTTP interceptors configured | âœ… |
| Rate limit handling implemented | âœ… |
| Form validation with Zod | âœ… |
| Error boundaries and user feedback | âœ… |
| Custom hooks for reusable logic | âœ… |
| TypeScript interfaces defined | âœ… |
| Loading states implemented | âœ… |
| Toast notifications working | âœ… |
| Image optimization with Next.js | âœ… |
| Rich text editor functionality | âœ… |
| Authentication flows complete | âœ… |
| Middleware protection active | âœ… |
| Animation components used (AnimatedSection/Grid/Header) | âœ… |
| Skeletonize with placeholder divs | âœ… |
| No animation conflicts with skeleton | âœ… |
| Page metadata (usePageMetadata) implemented | âœ… |
| Breadcrumb navigation added (if nested route) | âœ… |

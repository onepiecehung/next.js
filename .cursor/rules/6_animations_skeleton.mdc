---
alwaysApply: true
---

# üé¨ Animations & Skeleton Loading

## Global Animation System

**Location:** `src/lib/utils/animations.ts` and `src/components/shared/`

### Animation Components

Use these reusable components for consistent animations across the app:

1. **`AnimatedSection`** - Wrapper for page sections with fade + slide up
2. **`AnimatedGrid`** - Wrapper for grids with stagger animations
3. **`AnimatedHeader`** - Wrapper for section headers with fade + slide down

### Animation Variants

Pre-configured variants in `src/lib/utils/animations.ts`:
- `sectionVariants` - Fade + slide up (opacity: 1 in hidden state for skeleton visibility)
- `containerVariants` - Stagger container (opacity: 1 in hidden state)
- `itemVariants` - Stagger items (opacity: 1 in hidden state)
- `headerVariants` - Fade + slide down
- `slideRightVariants` - Slide in from right (for sidebars)
- `fadeVariants` - Simple fade in/out
- `scaleVariants` - Scale from center

**Critical:** Animation variants MUST keep `opacity: 1` in `hidden` state to allow skeleton to be visible during loading.

## Skeleton Loading

**Component:** `Skeletonize` from `@/components/shared`

### Usage Pattern

```tsx
import { AnimatedSection, AnimatedGrid, AnimatedHeader, Skeletonize } from "@/components/shared";

<AnimatedSection loading={isLoading} data={data} className="py-8">
  <AnimatedHeader loading={isLoading} data={data} className="mb-4">
    <h2>Section Title</h2>
  </AnimatedHeader>
  
  <Skeletonize loading={isLoading}>
    {data && data.length > 0 ? (
      <AnimatedGrid loading={isLoading} data={data} className="grid grid-cols-3">
        {data.map((item) => (
          <Card key={item.id}>{item.name}</Card>
        ))}
      </AnimatedGrid>
    ) : (
      // Always provide placeholder divs when loading
      <div className="grid grid-cols-3 gap-4">
        {[1, 2, 3, 4, 5, 6].map((i) => (
          <div key={i} className="aspect-[2/3] rounded" />
        ))}
      </div>
    )}
  </Skeletonize>
</AnimatedSection>
```

### Rules

1. **Always provide placeholder divs** when using conditional rendering
   - ‚ùå `{data && <Content />}` - Skeletonize has nothing to skeletonize
   - ‚úÖ `{data ? <Content /> : <PlaceholderDivs />}` - Always has children

2. **Placeholder divs must have dimension classes**
   - Use `h-*`, `w-*`, or `aspect-*` classes
   - CSS will automatically apply skeleton shimmer to these

3. **Animation components must receive `loading` and `data` props**
   - `AnimatedSection`: `loading={isLoading} data={data}`
   - `AnimatedGrid`: `loading={isLoading} data={data}`
   - `AnimatedHeader`: `loading={isLoading} data={data}`

4. **Animation variants keep opacity: 1 in hidden state**
   - This allows skeleton to be visible during loading
   - Only animate `y`, `x`, `scale` properties, not `opacity`

5. **Skeletonize wraps content, not animation components**
   - Place `Skeletonize` inside `AnimatedSection`, not wrapping it
   - Animation components handle visibility, Skeletonize handles styling

### CSS Skeleton Styles

Located in `src/app/globals.css`:
- `.skeletonize` class applies shimmer animation
- Automatically targets: `div[class*="h-"]`, `div[class*="w-"]`, `div[class*="aspect-"]`
- Dark mode support included
- Text elements, images, buttons automatically skeletonized

### Integration with Loading States

```tsx
// ‚úÖ Correct pattern
<AnimatedSection loading={isLoading} data={data}>
  <Skeletonize loading={isLoading}>
    {data ? <Content /> : <PlaceholderDivs />}
  </Skeletonize>
</AnimatedSection>

// ‚ùå Wrong - no placeholder
<AnimatedSection loading={isLoading} data={data}>
  <Skeletonize loading={isLoading}>
    {data && <Content />}  // null when loading = skeleton has nothing
  </Skeletonize>
</AnimatedSection>
```

## Best Practices

1. **Use animation components for all sections** - Consistent animations across app
2. **Always provide placeholders** - Skeletonize needs children to work
3. **Pass loading and data props** - Animation components need these to prevent conflicts
4. **Keep opacity: 1 in hidden state** - Allows skeleton visibility
5. **Use dimension classes on placeholders** - `h-*`, `w-*`, `aspect-*` for CSS matching
6. **Test skeleton visibility** - Ensure skeleton shows during loading states

## Definition of Done - Animations

| Check | Status |
|-------|--------|
| Animation components used (AnimatedSection/Grid/Header) | ‚úÖ |
| Skeletonize with placeholder divs | ‚úÖ |
| Loading and data props passed to animation components | ‚úÖ |
| Animation variants keep opacity: 1 in hidden state | ‚úÖ |
| Skeleton visible during loading | ‚úÖ |
| Smooth transitions when data loads | ‚úÖ |
| No animation conflicts with skeleton | ‚úÖ |
